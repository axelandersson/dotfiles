#!/usr/bin/perl -w

use strict;
use CLI;
use CLI::Git;

my $options = CLI::options();

CLI::usage() if $options->{"help"};

my $pager = CLI::Git::pager();
my @input = CLI::Git::log_refs(["refs/heads", "refs/remotes"]);
my @output;

foreach my $log (@input) {
    my $line;

    if($log->{"ref"} =~ /^origin/) {
        $line .= CLI::Git::remoterefstring($log->{"ref"});
    } else {
        $line .= CLI::Git::localrefstring($log->{"ref"});
    }

    $line .= CLI::Git::authorstring(" " . $log->{"author"});
    $line .= CLI::Git::datestring(" " . $log->{"author-relative"});
    $line .= CLI::Git::commitstring(" " . $log->{"commit"});
    $line .= CLI::Git::subjectstring(" " . $log->{"subject"});

    push(@output, CLI::terminalwidthstring($line));
}

CLI::run($pager, { "input" => \@output });
